<?xml version="1.0" encoding="UTF-8"?>
<!-- Defines a Galacticus model to test mass conservation. -->
<!-- Andrew Benson                                         -->
<!-- 28-April-2016                                         -->
<parameterGrid>
  <emailReport>no</emailReport>
  <doAnalysis>no</doAnalysis>
  <modelRootDirectory>testSuite/outputs/test-mass-conservation-coldMode</modelRootDirectory>
  <baseParameters>parameters.xml</baseParameters>
  <launchMethod>pbs</launchMethod>
  <pbs>
    <ompThreads>16</ompThreads>
    <maxJobsInQueue>40</maxJobsInQueue>
  </pbs>

  <parameters>
  <formatVersion>2</formatVersion>
  <version>0.9.4</version>

    <!-- Component selection -->
    <treeNodeMethodBasic value="standard"/>
    <treeNodeMethodBlackHole value="standard"/>
    <treeNodeMethodDarkMatterProfile value="scale"/>
    <treeNodeMethodDisk value="standard"/>
    <treeNodeMethodHotHalo value="coldMode"/>
    <treeNodeMethodSatellite value="standard"/>
    <treeNodeMethodSpheroid value="standard"/>
    <spheroidMassDistribution value="hernquist">
      <dimensionless value="true"/>
    </spheroidMassDistribution>
    <diskMassDistribution value="exponentialDisk">
      <dimensionless value="true"/>
    </diskMassDistribution>
    <treeNodeMethodSpin value="random"/>
    <treeNodeMethodPosition value="null"/>
    <treeNodeMethodAgeStatistics value="null"/>
    <treeNodeMethodIndices value="null"/>

    <!-- Cosmological parameters and options -->
    <cosmologyFunctionsMethod value="matterLambda"/>
    <cosmologyParametersMethod value="simple">
      <HubbleConstant value="67.8100148730579"/>
      <OmegaMatter value="0.30766318"/>
      <OmegaDarkEnergy value="0.69233682"/>
      <OmegaBaryon value="0.048404634"/>
      <temperatureCMB value="2.72548"/>
    </cosmologyParametersMethod>

    <!-- Power spectrum options -->
    <transferFunctionMethod value="eisensteinHu1999">
      <neutrinoNumberEffective value="3.04"/>
      <neutrinoMassSummed value="0.0"/>
    </transferFunctionMethod>
    <powerSpectrumPrimordialMethod value="powerLaw">
      <index value="0.96763953040293"/>
      <wavenumberReference value="1.0"/>
      <running value="0.0"/>
    </powerSpectrumPrimordialMethod>
    <powerSpectrumPrimordialTransferredMethod value="simple"/>
    <cosmologicalMassVarianceMethod value="filteredPower">
      <sigma_8 value="0.814932725148418"/>
    </cosmologicalMassVarianceMethod>
    <powerSpectrumNonlinearMethod value="peacockDodds1996"/>

    <!-- Structure formation options -->
    <linearGrowthMethod value="simple"/>
    <haloMassFunctionMethod value="simpleSystematic">
      <alpha value="-0.0197873321812387"/>
      <beta value="0.00986021548527724"/>
      <haloMassFunctionMethod value="tinker2008"/>
    </haloMassFunctionMethod>
    <criticalOverdensityMethod value="sphericalCollapseMatterLambda"/>
    <virialDensityContrastMethod value="percolation">
      <linkingLength value="0.2"/>
    </virialDensityContrastMethod>

    <!-- Merger tree building options -->
    <mergerTreeConstructorMethod value="build"/>
    <mergerTreeBuildMassesMethod value="sampledDistributionUniform">
      <massTreeMinimum value="1.0e10"/>
      <massTreeMaximum value="1.0e12"/>
      <treesPerDecade value="10"/>
    </mergerTreeBuildMassesMethod>
    <mergerTreeMassResolutionMethod value="fixed">
      <massResolution value="1.0e9"/>
    </mergerTreeMassResolutionMethod> 
    <mergerTreeBuildMassDistributionMethod value="haloMassFunction">
      <abundanceMaximum value="1.0e-1"/>
      <abundanceMinimum value="1.0e-8"/>    
    </mergerTreeBuildMassDistributionMethod>
    <mergerTreeBuilderMethod value="cole2000">
      <branchIntervalStep value="true"/>
      <mergeProbability value="0.1"/>
      <redshiftMaximum value="10.0"/>
      <accretionLimit value="0.1"/>
    </mergerTreeBuilderMethod>
    <mergerTreeBranchingProbabilityMethod value="parkinsonColeHelly">
      <G0 value="+0.570"/>
      <gamma1 value="+0.380"/>
      <gamma2 value="-0.010"/>
      <accuracyFirstOrder value="+0.025"/>
      <hypergeometricTabulate value="true"/>
      <precisionHypergeometric value="1.0e-6"/>
      <cdmAssumptions value="true"/>
    </mergerTreeBranchingProbabilityMethod>

    <!-- Substructure hierarchy options -->
    <nodeMergersMethod value="singleLevelHierarchy"/>

    <!-- Prevent negative accretion -->
    <hotHaloNodeMergerLimitBaryonFraction value="true"/>
    <hotHaloAngularMomentumAlwaysGrows value="true"/>
    
    <!-- Outputs and analyses -->
    <outputRedshifts value="0.0000"/>

    <!-- Dark matter halo structure options -->
    <darkMatterProfileMethod value="NFW"/>
    <darkMatterProfileConcentrationMethod value="diemerKravtsov2014">
      <alpha value="1.12"/>
      <beta value="1.69"/>
      <eta0 value="6.82"/>
      <eta1 value="1.42"/>
      <kappa value="0.69"/>
      <phi0 value="6.7095654472093482"/>
      <phi1 value="1.37"/>
    </darkMatterProfileConcentrationMethod>
    <darkMatterProfileMinimumConcentration value="4"/>
    <haloSpinDistributionMethod value="bett2007">
      <alpha value="2.5094130785911624"/>
      <lambda0 value="4.3325030697269937E-002"/>
    </haloSpinDistributionMethod>
    <randomSpinResetMassFactor value="2.0"/>

    <!-- Halo accretion options -->
    <accretionHaloMethod value="coldMode">
      <redshiftReionization value="10.5"/>
      <velocitySuppressionReionization value="35.0"/>
      <accretionNegativeAllowed value="false"/>
    </accretionHaloMethod>
    <intergalacticMediumStateMethod value="file">
      <fileName value="constraints/data/igmState.xml"/>
    </intergalacticMediumStateMethod>

    <!-- Hot halo gas cooling model options -->
    <coolingRateMethod value="whiteFrenk1991">
      <velocityCutOff value="10000"/>
    </coolingRateMethod>
    <hotHaloMassDistributionMethod value="betaProfile"/>
    <hotHaloTemperatureProfileMethod value="virial"/>
    <hotHaloMassDistributionCoreRadiusMethod value="virialFraction">
      <coreRadiusOverVirialRadius value="0.3"/>
    </hotHaloMassDistributionCoreRadiusMethod>
    <hotHaloAngularMomentumLossFraction value="0.3"/>
    <coolingSpecificAngularMomentumMethod value="constantRotation">
      <sourceAngularMomentumSpecificMean value="hotGas"/>
      <sourceNormalizationRotation value="hotGas"/>
    </coolingSpecificAngularMomentumMethod>
    <hotHaloOutflowReincorporationMethod value="haloDynamicalTime">
    <multiplier value="5.0"/>
  </hotHaloOutflowReincorporationMethod>

  <coolingFunctionMethod value="atomicCIECloudy"/>
    <coolingRadiusMethod value="simple"/>
    <coolingTimeMethod value="simple">
      <degreesOfFreedom value="3.0"/>
    </coolingTimeMethod>
    <coolingTimeAvailableMethod value="whiteFrenk1991">
      <ageFactor value="0"/>
    </coolingTimeAvailableMethod>
    <starveSatellites value="false"/>

    <!-- Hot halo ram pressure stripping options -->
    <hotHaloRamPressureStrippingMethod value="font2008"/>
    <hotHaloRamPressureForceMethod value="font2008"/>
    <hotHaloRamPressureTimescaleMethod value="ramPressureAcceleration"/>
    <hotHaloOutflowStrippingEfficiency value="0.1"/>
    <hotHaloTrackStrippedGas value="true"/>
    <ramPressureStrippingFormFactor value="2"/>

    <!-- Galaxy ram pressure stripping options -->
    <ramPressureStrippingDisksMethod value="null"/>
    <ramPressureStrippingSpheroidsMethod value="null"/>

    <!-- Galaxy tidal stripping options -->
    <tidalStrippingDisksMethod value="null"/>
    <tidalStrippingSpheroidsMethod value="null"/>
    <satelliteTidalFieldMethod value="null"/>

    <!-- Galactic structure solver options -->
    <galacticStructureRadiusSolverMethod value="adiabatic"/>
    <adiabaticContractionGnedinA value="0.73"/>
    <adiabaticContractionGnedinOmega value="0.7"/>
    <spheroidAngularMomentumAtScaleRadius value="0.5"/>

    <!-- Galactic disk dynamics options -->
    <galacticDynamicsBarInstabilityMethod value="efstathiou1982">
      <stabilityThresholdGaseous value="0.7"/>
      <stabilityThresholdStellar value="1.1"/>
    </galacticDynamicsBarInstabilityMethod>
    <!-- Star formation rate options -->
    <starFormationTimescaleDisksMethod value="intgrtdSurfaceDensity">
      <tolerance value="1.0e-2"/>
      <timescaleMinimum value="0.001"/>
    </starFormationTimescaleDisksMethod>

    <starFormationRateSurfaceDensityDisksMethod value="krumholz2009">
      <frequencyStarFormation value="0.385"/>
      <clumpingFactorMolecularComplex value="5.000"/>
      <molecularFractionFast value="true"/>
    </starFormationRateSurfaceDensityDisksMethod>
    <starFormationTimescaleSpheroidsMethod value="dynamicalTime">
      <efficiency       value="0.04"/>
      <exponentVelocity value="2.0"/>
      <timescaleMinimum value="0.001"/>
    </starFormationTimescaleSpheroidsMethod>

  <!-- Stellar populations options -->
    <stellarPopulationPropertiesMethod value="instantaneous"/>
    <stellarPopulationSpectraMethod value="FSPS"/>
    <imfSelectionMethod value="fixed"/>
    <imfSelectionFixed value="Chabrier"/>
    <imfChabrierRecycledInstantaneous value="0.46"/>
    <imfChabrierYieldInstantaneous value="0.035"/>

    <!-- AGN feedback options -->
    <hotHaloExcessHeatDrivesOutflow value="true"/>
    <blackHoleHeatsHotHalo value="false"/>

    <!-- Supernovae feedback options -->
    <starFormationFeedbackDisksMethod value="powerLaw">
      <velocityCharacteristic value="250.0"/>
      <exponent value="3.5"/>
    </starFormationFeedbackDisksMethod>
    <starFormationFeedbackSpheroidsMethod value="powerLaw">
      <exponent value="3.5"/>
      <velocityCharacteristic value="100.0"/>
    </starFormationFeedbackSpheroidsMethod>

    <!-- Accretion disk properties -->
    <accretionDisksMethod value="switched">
      <accretionRateThinDiskMaximum value="0.30"/>
      <accretionRateThinDiskMinimum value="0.01"/>
      <scaleADAFRadiativeEfficiency value="true"/>
      <accretionDisksShakuraSunyaevMethod value="shakuraSunyaev"/>
      <accretionDisksADAFMethod value="ADAF">
	<efficiencyRadiationType value="thinDisk"/>
	<adiabaticIndex value="1.444"/>
	<energyOption value="pureADAF"/>
	<efficiencyRadiation value="0.01"/>
	<viscosityOption value="fit"/>
      </accretionDisksADAFMethod>
    </accretionDisksMethod>

    <!-- Black hole options -->
    <blackHoleBinaryMergersMethod value="Rezzolla2008"/>
    <blackHoleSeedMass value="0"/>
    <blackHoleWindEfficiency value="0.0024"/>
    <blackHoleWindEfficiencyScalesWithRadiativeEfficiency value="true"/>
    <bondiHoyleAccretionEnhancementHotHalo value="6.0"/>
    <bondiHoyleAccretionEnhancementSpheroid value="5.0"/>
    <bondiHoyleAccretionTemperatureSpheroid value="100"/>
    <bondiHoyleAccretionHotModeOnly value="true"/>

    <!-- Satellite orbit options -->
    <satelliteOrbitStoreOrbitalParameters value="true"/>

    <!-- Galaxy merger options -->
    <virialOrbitMethod value="benson2005"/>
    <satelliteMergingTimescalesMethod value="jiang2008"/>
    <mergingTimescaleMultiplier value="0.75"/>
    <satelliteMergingMassMovementsMethod value="simple"/>
    <minorMergerGasMovesTo value="spheroid"/>
    <satelliteMergingRemnantSizeMethod value="Cole2000"/>
    <majorMergerMassRatio value="0.25"/>
    <mergerRemnantSizeOrbitalEnergy value="1"/>

    <!-- Spheroid options -->
    <spheroidEnergeticOutflowMassRate value="1.0e-2"/>

    <!-- Numerical tolerances -->
    <odeToleranceAbsolute value="1.0e-6"/>
    <odeToleranceRelative value="1.0e-6"/>
    <diskMassToleranceAbsolute value="1.0e-6"/>
    <spheroidMassToleranceAbsolute value="1.0e-6"/>
    <timestepHostAbsolute value="1.0"/>
    <timestepHostRelative value="0.1"/>
    <timestepSimpleAbsolute value="1.0"/>
    <timestepSimpleRelative value="0.1"/>

    <!-- Output options -->
    <mergerTreeOutput>
      <outputReferences value="false"/>
    </mergerTreeOutput>

  </parameters>

</parameterGrid>
